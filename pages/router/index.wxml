<view class="page-container">
  <!-- ÁªèÈ™åÂÄºÊòæÁ§∫ -->
  <view class="experience-badge">
    <text class="star">‚≠ê</text>
    <text>{{totalExperience}}ÂàÜ</text>
  </view>
  <!-- Â≠¶‰π†ËøõÂ∫¶Êù° -->
  <view class="progress-section">
    <view class="progress-container">
      <view class="progress-bar-wrapper">
        <view class="progress-bar">
          <view class="progress-fill" style="width: {{progressPercent}}%;">
            <view class="progress-indicator" style="left: 100%;">
              <view class="indicator-outer-ring">
                <view class="indicator-inner-circle"></view>
              </view>
            </view>
          </view>
        </view>
        <view class="progress-text">{{progressPercent}}%</view>
      </view>
    </view>
  </view>
  
  <view wx:key="id" wx:for="{{allCourses}}" class="page-line" style="margin-left:20rpx;padding-left: {{item.position}}; height: 100rpx;">
    <block wx:for="{{item.asssignIds}}" wx:for-item="subItem" wx:for-index="idx">
      <image style="opacity: {{ (subItem >= 0 && assignments[subItem-1].status === 'locked') ? 0.4 : 1 }};" wx:key="id" src="{{ assignments[subItem-1].status === 'locked' || assignments[subItem-1].status === 'available' ? '/images/work-icon-no.svg' : '/images/work-icon-done.svg'}}" class="item-image-mini {{assignments[subItem-1].status === 'available' ? 'available' : ''}}" data-index="{{idx}}" data-status="{{item.status}}" data-id="{{item.id}}" data-extra="{{item.otherData}}" bindtap="showAssignmentDialog" />
    </block>
    <image style="opacity: {{ (item.status === 'locked') ? 0.2 : 1 }};" src="{{item.icon}}" class="item-image {{item.status === 'available' ? 'available' : ''}}" data-id="{{item.id}}" data-title="{{item.title}}" data-status="{{item.status}}" bindtap="showCourseDialog" />
  </view>

  <!-- Á°ÆËÆ§ÂºπÁ™ó -->
  <view class="dialog-mask" wx:if="{{showDialog}}" bindtap="hideDialog" catchtouchmove="preventTouchMove">
    <view class="dialog-container" catchtap="stopPropagation">
      <!-- È°∂ÈÉ®Ë£ÖÈ•∞‰∏âËßíÂΩ¢ -->
      <view class="dialog-triangle"></view>

      <!-- ÂºπÁ™óÂÜÖÂÆπ -->
      <view class="dialog-content">
        <!-- ÂõæÊ†á -->
        <view class="dialog-icon">
          <image wx:if="{{dialogData.iconUrl}}" src="{{dialogData.iconUrl}}" class="dialog-icon-image" mode="aspectFit" />
          <text wx:else class="dialog-emoji">{{dialogData.emoji}}</text>
        </view>

        <!-- Ê†áÈ¢ò -->
        <view class="dialog-title">{{dialogData.title}}</view>

        <!-- ÊèèËø∞ -->
        <view class="dialog-desc">{{dialogData.desc}}</view>

        <!-- È¢ùÂ§ñ‰ø°ÊÅØ -->
        <view class="dialog-info" wx:if="{{dialogData.info}}">
          <text class="info-icon">‚ÑπÔ∏è</text>
          <text class="info-text">{{dialogData.info}}</text>
        </view>

        <!-- ÊåâÈíÆ -->
        <view class="dialog-buttons {{dialogData.showCancel === false ? 'single-button' : ''}}">
          <view class="dialog-btn dialog-btn-cancel" wx:if="{{dialogData.showCancel !== false}}" bindtap="hideDialog">
            <text>ÂèñÊ∂à</text>
          </view>
          <view class="dialog-btn dialog-btn-confirm" bindtap="confirmDialog">
            <text>{{dialogData.confirmText}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- Êñ∞ÊâãÂØºÂºïÁªÑ‰ª∂ -->
  <guide
    show="{{showGuide}}"
    steps="{{guideSteps}}"
    bind:complete="onGuideComplete"
    bind:stepchange="onGuideStepChange"
  />

  <!-- DebugÊåâÈíÆ -->
  <view wx:if="{{showDebugButtons}}" class="debug-buttons">
    <button class="debug-btn debug-btn-clear" bindtap="debugClearAllProgress">
      üóëÔ∏è Ê∏ÖÁ©∫ËÆ∞ÂΩï
    </button>
    <button class="debug-btn debug-btn-complete" bindtap="debugCompleteAllCourses">
      ‚úÖ ÂÆåÊàêÂÖ®ÈÉ®
    </button>
  </view>

</view>