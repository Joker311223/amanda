<view class="page-container">
  <!-- 经验值显示 -->
  <view class="experience-badge">
    <text class="star">⭐</text>
    <text>30分</text>
  </view>

  <!-- 课程标题 -->
  <view class="course-header">
    <view class="course-title-card card">
      <view class="card-header">
        <text>第二课　正念、智慧心</text>
      </view>
    </view>
  </view>

  <!-- 视频播放区域 -->
  <view class="video-section">
    <view class="video-container">
      <!-- 模拟视频播放器 -->
      <view class="video-player">
        <video autoplay wx:if="{{videoUrl}}" id='center' controls src="{{videoUrl}}" class="video-placeholder" bindended="onVideoEnded"/>
      </view>
    </view>

    <!-- 笔记功能 -->
    <view class="notes-section">
      <view class="notes-card card">
        <view class="card-header">
          <text>学习笔记</text>
        </view>
        <view class="card-content">
          <textarea
            class="notes-textarea"
            placeholder="记录你的学习心得和感悟..."
            value="{{notes}}"
            bindinput="onNotesInput"
            maxlength="500"
          ></textarea>
          <view class="notes-footer">
            <text class="char-count">{{notes.length}}/500</text>
            <button class="btn btn-primary save-notes-btn" bindtap="saveNotes">
              保存笔记
            </button>
          </view>
        </view>
      </view>
    </view>

    <!-- 完成学习按钮 -->
    <view class="complete-section">
      <button
        class="btn btn-primary complete-btn"
        bindtap="completeCourse"
        disabled="{{!isFinied}}"
      >
        {{!isFinied? '请完整观看视频' : '完成学习'}}
      </button>
    </view>
  </view>

  <!-- 完成弹窗 -->
  <view class="completion-modal" wx:if="{{showExperienceGain}}" bindtap="continueJourney">
    <view class="modal-content" catchtap="stopPropagation">
      <!-- 冰淇淋插图 -->
      <view class="celebration-icon">
        <view class="ice-cream">
          <view class="ice-cream-cone">
            <view class="cone-face">
              <view class="cone-eye left">•</view>
              <view class="cone-eye right">•</view>
              <view class="cone-mouth">ᴗ</view>
            </view>
          </view>
          <view class="ice-cream-scoops">
            <view class="scoop yellow"></view>
            <view class="scoop blue"></view>
            <view class="scoop orange"></view>
          </view>
        </view>
        <!-- 装饰元素 -->
        <view class="decoration-particles">
          <view class="particle star" style="top: 20rpx; left: 80rpx; color: #FFD700;">✦</view>
          <view class="particle star" style="top: 60rpx; right: 100rpx; color: #7ed321;">✦</view>
          <view class="particle circle" style="top: 100rpx; left: 60rpx; background: #FF6B6B;"></view>
          <view class="particle circle" style="top: 40rpx; right: 80rpx; background: #4ECDC4;"></view>
          <view class="particle plus" style="bottom: 120rpx; left: 100rpx; color: #FFD700;">+</view>
          <view class="particle plus" style="bottom: 140rpx; right: 120rpx; color: #FF6B6B;">+</view>
          <view class="particle dot" style="top: 80rpx; left: 120rpx; background: #7ed321;"></view>
          <view class="particle dot" style="bottom: 160rpx; right: 100rpx; background: #FFD700;"></view>
        </view>
      </view>

      <!-- 分数显示 -->
      <view class="points-display">
        <text class="points-number">{{currentCourse.experience || 30}}</text>
        <text class="points-unit">分</text>
      </view>

      <!-- 提示文字 -->
      <view class="completion-message">
        <text>恭喜你成功解锁{{currentCourse.experience || 30}}分经验</text>
      </view>

      <!-- 继续按钮 -->
      <button class="continue-btn" bindtap="continueJourney">继续</button>
    </view>
  </view>
</view>
