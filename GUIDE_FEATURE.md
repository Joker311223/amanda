# 新手导引功能说明

## 功能概述

在用户完成注册后，系统会自动引导用户到学习路线页面（router页面），并通过动画导引帮助用户了解如何使用课程学习和作业完成功能。

## 实现的功能

### 1. 导引组件 (`components/guide/`)
- **遮罩层**：半透明黑色背景，突出高亮区域
- **高亮区域**：通过box-shadow实现镂空效果，带有脉冲动画
- **提示框**：包含图标、标题、描述和操作按钮
- **箭头指示器**：根据位置自动调整方向
- **动画效果**：淡入、滑入和脉冲动画

### 2. 导引流程

#### 步骤1：欢迎
- 居中显示欢迎信息
- 介绍学习路线页面的作用

#### 步骤2：课程学习
- 高亮显示第一个可用的课程图标
- 说明如何点击课程观看视频
- 介绍经验值获取机制

#### 步骤3：作业练习
- 高亮显示第一个可用的作业图标
- 说明作业的解锁条件
- 强调作业对巩固知识的重要性

#### 步骤4：经验值系统
- 高亮显示经验值徽章
- 介绍经验值的作用和获取方式

#### 步骤5：开始学习
- 居中显示鼓励信息
- 引导用户开始第一个课程

## 触发条件

导引会在以下情况下自动显示：
1. 用户刚完成注册（`isFirstTime = false`）
2. 用户还未看过导引（`hasSeenGuide = false`）
3. 用户进入router页面（学习路线页面）

## 数据存储

在 `app.js` 的 `globalData` 中添加了：
```javascript
hasSeenGuide: false  // 是否已看过导引
```

该状态会通过 `wx.setStorageSync` 持久化存储，确保用户只看到一次导引。

## 用户流程

1. **注册** → 填写用户信息 → 提交
2. **跳转** → 自动跳转到学习路线页面（router）
3. **导引** → 自动显示新手导引（5个步骤）
4. **完成** → 点击"开始学习"完成导引
5. **学习** → 开始课程学习和作业练习

## 文件修改清单

### 新增文件
- `components/guide/guide.wxml` - 导引组件模板
- `components/guide/guide.wxss` - 导引组件样式
- `components/guide/guide.js` - 导引组件逻辑
- `components/guide/guide.json` - 导引组件配置

### 修改文件
- `app.js` - 添加 `hasSeenGuide` 状态管理
- `pages/onboarding/onboarding.js` - 修改注册完成后的跳转逻辑
- `pages/router/index.json` - 引入guide组件
- `pages/router/index.wxml` - 添加guide组件标签
- `pages/router/index.js` - 添加导引显示逻辑

## 测试步骤

### 测试新用户导引
1. 清除小程序缓存（开发工具：清除缓存 → 清除数据缓存）
2. 重新编译运行
3. 进入onboarding页面
4. 点击"下一步"进入用户信息填写
5. 填写完整信息并提交
6. 观察是否自动跳转到router页面
7. 等待0.5秒后应该自动显示导引
8. 按照导引步骤操作，检查每个步骤的高亮和提示是否正确
9. 完成导引后，检查是否显示"开始学习吧！"提示

### 测试导引只显示一次
1. 完成上述测试后
2. 切换到其他tab页面
3. 再次切换回router页面
4. 确认导引不再显示

### 测试老用户不显示导引
1. 使用已注册过的账号（hasSeenGuide = true）
2. 进入router页面
3. 确认不显示导引

## 自定义配置

### 修改导引步骤
在 `pages/router/index.js` 的 `showNewUserGuide()` 方法中修改 `guideSteps` 数组：

```javascript
{
  icon: '😊',           // 步骤图标（emoji）
  title: '步骤标题',    // 步骤标题
  desc: '步骤描述',     // 步骤详细描述
  selector: '.class',   // 要高亮的元素选择器（null表示居中显示）
  padding: 10          // 高亮区域的内边距（px）
}
```

### 修改导引样式
在 `components/guide/guide.wxss` 中修改：
- `.guide-mask` - 遮罩层样式
- `.guide-highlight` - 高亮区域样式
- `.guide-tip` - 提示框样式
- 动画关键帧 - `@keyframes`

## 注意事项

1. **选择器准确性**：确保 `selector` 能正确选中目标元素
2. **页面渲染时机**：导引在 `onShow` 中延迟500ms显示，确保页面元素已渲染
3. **z-index层级**：导引组件的z-index为9999，确保在最上层
4. **用户体验**：导引不能通过点击遮罩关闭，必须完成所有步骤
5. **响应式适配**：提示框位置会根据屏幕空间自动调整

## 未来优化建议

1. 添加"跳过导引"功能
2. 支持导引步骤的动态配置
3. 添加导引进度保存，支持中断后继续
4. 支持更多的高亮形状（圆形、椭圆等）
5. 添加导引完成后的成就奖励
6. 支持多页面导引流程

## 技术亮点

1. **组件化设计**：导引功能封装为独立组件，可复用
2. **自动位置计算**：根据目标元素位置自动计算提示框位置
3. **优雅的动画**：使用CSS动画实现流畅的视觉效果
4. **状态持久化**：使用本地存储确保导引只显示一次
5. **灵活配置**：通过配置数组轻松定制导引步骤
